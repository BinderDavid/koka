<!DOCTYPE html>
<html>
<!-- NO_CLICK_TRACKING -->

<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />

<style type="text/css">.koka .plaincode, .koka a.pp .pc { display: none; } .koka a.pp { color: inherit; text-decoration: none; }</style>
<link rel="stylesheet" type="text/css" href="styles/madoko.css" />
<link rel="stylesheet" type="text/css" href="styles/koka.css" />

<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto+Serif:400,400italic,700,700italic" />
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700,400italic" />

<title>decimal.kk documentation</title>
</head>

<body class="koka doc body"><div class="madoko">
<pre class="koka source"><span class="comment">/&#42;---------------------------------------------------------------------------
  Copyright 2012-2016 Microsoft Corporation.
 
  This is free software; you can redistribute it and/or modify it under the
  terms of the Apache License, Version 2.0. A copy of the License can be
  found in the file "license.txt" at the root of this distribution.
---------------------------------------------------------------------------&#42;/</span>

<span class="comment">// Operations on arbitrary precision decimal numbers.
//
// Note: this module is work in progress. 
</span><span class="kw">module</span> decimal

<span class="kw">import</span> regex

<span class="comment">// Type of a decimal number.
</span><span class="decl-type" id="type_space_decimal"><span class="kw">public</span> <span class="tp kw">struct</span> <span class="decl-con" id="con_space_Decimal"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> (
  <span class="decl-fun" id="whole"><a class="pp">whole<span class="pc">whole: <span class="tp">int</span></span></a></span><span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
  <span class="decl-fun" id="frac"><a class="pp">frac<span class="pc">frac: <span class="tp">int</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>,
  <span class="decl-fun" id="prec"><a class="pp">prec<span class="pc">prec: <span class="tp">int</span></span></a></span> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>                        
</span></span>)

<span class="comment">// The decimal zero.
</span><span class="decl-val" id="zero"><span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#zero">zero<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>zero: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span></span>)

<span class="comment">// Create a decimal number with maximal precision from a 
// whole part &#96;i&#96; and fractional part &#96;frac&#96;. The result is &#96;i + frac&#96;&amp;times;10^-&#96;prec&#96;^.
// i.e. &#96;prec&#96; determines how far to shift the fraction. By default &#96;prec&#96; is negative which
// means it will take the width of &#96;frac&#96; in digits as its precision.\
// &#96;decimal(1,123,4).show == "1.0123"&#96;\
// &#96;decimal(1,123).show == "1.123"&#96;\
// &#96;decimal(123).show == "123"&#96;
</span><span class="decl-fun" id="decimal"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#decimal">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">frac<span class="pc">frac: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span>, <a class="pp">prec<span class="pc">prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">frac</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">prec<span class="pc">prec: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>,<span class="number">0</span>,<span class="number">0</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  <span class="kw">val</span> <a class="pp">fprec<span class="pc">fprec: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#max">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">frac<span class="pc">frac: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#count_digits">count-digits<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count<span class="dash">-</span>digits: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">prec<span class="pc">prec: <span class="tp">int</span></span></a>)
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">frac</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#neg_ques__1">neg?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>neg?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> {
    <span class="kw">val</span> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pow10">pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pow10: <span class="tp sp">(</span><span class="tp tpp">exp</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">fprec<span class="pc">fprec: <span class="tp">int</span></span></a>)
    <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#dec">dec<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>dec: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">frac<span class="pc">frac: <span class="tp">int</span></span></a>, <a class="pp">fprec<span class="pc">fprec: <span class="tp">int</span></span></a>)
  }
  <span class="kw">else</span> {
    <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>, <a class="pp">frac<span class="pc">frac: <span class="tp">int</span></span></a>, <a class="pp">fprec<span class="pc">fprec: <span class="tp">int</span></span></a>)
  }
</span>}

<span class="comment">// Create a decimal from a &#96;:double&#96; with a specified maximal precision (=&#96;16&#96;).
</span><span class="decl-fun" id="decimal_1"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#decimal_1">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_double"><span class="tp">double</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp">V</span></span></a>, <a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">16</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">fl<span class="pc">fl: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#floor">floor<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>floor: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>
  <span class="kw">val</span> <a class="pp">fr<span class="pc">fr: <span class="tp">double</span></span></a> <span class="kw">=</span> <a class="pp">d<span class="pc">d: <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash__2">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>)<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp">fl<span class="pc">fl: <span class="tp">double</span></span></a>
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">fr</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques__1">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp" href="#decimal">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">fl<span class="pc">fl: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#int_2">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a> 
  <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">fr<span class="pc">fr: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_fixed">show-fixed<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="dash">-</span>fixed: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">,</span> <span class="tp tpp">precision</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#count_1">count<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">2</span>
  <a class="pp" href="#decimal">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">fl<span class="pc">fl: <span class="tp">double</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#int_2">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, (<a class="pp">fr<span class="pc">fr: <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star__1">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">double</span><span class="tp sp">,</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pow10_1">pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pow10<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#double">double<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>double: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">double</span></span></a>))<span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#int_2">int<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int<span class="postfix">.2</span>: <span class="tp sp">(</span><span class="tp tpp">d</span> <span class="tp kw op">:</span> <span class="tp">double</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Create a decimal from an integer by specifying how far to shift the dot (&#96;prec&#96;)\
// &#96;decimal-at(123).show == "123"&#96;\
// &#96;decimal-at(123,2).show == "1.23"&#96;
</span><span class="decl-fun" id="decimal_at"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#decimal_at">decimal-at<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal<span class="dash">-</span>at: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">prec<span class="pc">prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <span class="number">0</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">prec</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a>,<span class="number">0</span>,<span class="number">0</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  <span class="kw">val</span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#cdiv_pow10">cdiv-pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>cdiv<span class="dash">-</span>pow10: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">prec<span class="pc">prec: <span class="tp">int</span></span></a>)
  <span class="kw">val</span> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">i<span class="pc">i: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#mul_pow10">mul-pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>mul<span class="dash">-</span>pow10: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">prec<span class="pc">prec: <span class="tp">int</span></span></a>)
  <a class="pp" href="#decimal">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a>,<a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>,<a class="pp">prec<span class="pc">prec: <span class="tp">int</span></span></a>)
</span>}

<span class="decl-fun" id="expand"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#expand">expand<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_gt__eq__1">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="kw">else</span> {
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#trace">trace<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>trace: <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"expand: "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#show">show<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>show: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">" to prec "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>)
    <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#mul_pow10">mul-pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>mul<span class="dash">-</span>pow10: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>), <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
  }
</span>}

<span class="decl-fun" id="expand_int"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#expand_int">expand-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">p</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">int</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <span class="kw">val</span> <a class="pp">xx<span class="pc">xx: <span class="tp">decimal</span></span></a> <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#expand">expand<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
  <a class="pp">xx<span class="pc">xx: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#mul_pow10">mul-pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>mul<span class="dash">-</span>pow10: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">xx<span class="pc">xx: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
</span>}

<span class="decl-fun" id="reduce"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#reduce">reduce<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>reduce: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a>
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<span class="number">0</span>,<span class="number">0</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  <span class="kw">val</span> <a class="pp">z<span class="pc">z: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pow10_ques_">pow10?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pow10?: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">z<span class="pc">z: <span class="tp">int</span></span></a>
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#trace">trace<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>trace: <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"reduce "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#show">show<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>show: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">" to prec "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>)
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">!</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pos_ques__1">pos?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pos?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<span class="number">0</span>,<span class="number">0</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a> 
  <span class="kw">val</span> <a class="pp">factor<span class="pc">factor: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pow10">pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pow10: <span class="tp sp">(</span><span class="tp tpp">exp</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">z<span class="pc">z: <span class="tp">int</span></span></a>)
  <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">factor<span class="pc">factor: <span class="tp">int</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Add two decimals.
</span><span class="decl-fun" id="_plus_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#_plus_">(+)<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#max">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">p</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp" href="#decimal">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(): <span class="tp sp">(</span><span class="tp sp">)</span></span></a>
  <span class="kw">val</span> <a class="pp">xx<span class="pc">xx: <span class="tp">decimal</span></span></a> <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#expand">expand<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
  <span class="kw">val</span> <a class="pp">yy<span class="pc">yy: <span class="tp">decimal</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#expand">expand<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
  <span class="kw">val</span> <a class="pp">f<span class="pc">f: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">xx<span class="pc">xx: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">yy<span class="pc">yy: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">f</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#count_digits">count-digits<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>count<span class="dash">-</span>digits: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_gt__1">&gt;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>) <span class="kw">then</span> {
    <span class="kw">val</span> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pow10">pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pow10: <span class="tp sp">(</span><span class="tp tpp">exp</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
    <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>, <a class="pp">f<span class="pc">f: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="#reduce">reduce<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>reduce: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>
  }
  <span class="kw">else</span> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">f<span class="pc">f: <span class="tp">int</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="#reduce">reduce<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>reduce: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>
</span>}

<span class="comment">// Negate a decimal.
</span><span class="decl-fun" id="_tilde_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#_tilde_">(~)<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <a class="pp" href="#decimal">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Subtract two decimals.
</span><span class="decl-fun" id="_dash_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#_dash_">(-)<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <a class="pp" href="#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a> (<a class="pp" href="#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a><a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a>)
</span>}

<span class="comment">// Multiply two decimals up to a given precision &#96;max-prec&#96; (=&#96;~1&#96;).
// Use a negative precision to compute to the current maximum precision of either argument.
</span><span class="decl-fun" id="mul"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#mul">mul<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp" href="#decimal">decimal<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<span class="number">0</span>) <span class="kw">else</span> {
    <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#max">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)
    <span class="kw">val</span> <a class="pp">xi<span class="pc">xi: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#expand_int">expand-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
    <span class="kw">val</span> <a class="pp">yi<span class="pc">yi: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#expand_int">expand-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#trace">trace<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>trace: <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"mul: "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">xi<span class="pc">xi: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">" &#42; "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">yi<span class="pc">yi: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>)
    <span class="kw">val</span> <a class="pp">z<span class="pc">z: <span class="tp">decimal</span></span></a>  <span class="kw">=</span> <a class="pp" href="#decimal_at">decimal-at<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal<span class="dash">-</span>at: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">xi<span class="pc">xi: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">yi<span class="pc">yi: <span class="tp">int</span></span></a>, <span class="number">2</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> )<span class="kw op">.</span><a class="pp" href="#reduce">reduce<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>reduce: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>      <span class="comment">// TODO limit precision
</span>    <a class="pp">z<span class="pc">z: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#reduce">reduce<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>reduce: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>
  }  
</span>}

<span class="comment">// Multiply two decimals up to a given precision &#96;max-prec&#96; (=&#96;~1&#96;).
// Use a negative precision to compute to the current maximum precision of either argument.
</span><span class="decl-fun" id="_star_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#_star_">(&#42;)<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <a class="pp" href="#mul">mul<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>mul: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a>,<a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a>,<a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Divide two decimals up to a given precision &#96;max-prec&#96; (=&#96;~1&#96;).
// Use a negative precision to compute to the precision of the first argument.
</span><span class="decl-fun" id="div"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#div">div<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>div: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp"><span class="kw">return</span><span class="pc">return: <span class="tp">decimal</span></span></a> <a class="pp" href="#zero">zero<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>zero: <span class="tp">decimal</span></span></a>
  <span class="kw">val</span> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#max">max<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>max: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">j</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)
  <span class="kw">val</span> <a class="pp">xi<span class="pc">xi: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#expand_int">expand-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
  <span class="kw">val</span> <a class="pp">yi<span class="pc">yi: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#expand_int">expand-int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>expand<span class="dash">-</span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
  <span class="kw">val</span> <a class="pp">mp<span class="pc">mp: <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">max-prec</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_gt__eq__1">&gt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&gt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <span class="number">0</span>) <span class="kw">then</span> <a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp">int</span></span></a> <span class="kw">else</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  <span class="kw">val</span> <a class="pp">dp<span class="pc">dp: <span class="tp">int</span></span></a> <span class="kw">=</span> <span class="number">2</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_star_">&#42;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&#42;): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp">mp<span class="pc">mp: <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus_">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">1</span>
  <span class="kw">val</span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp">xi<span class="pc">xi: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#mul_pow10">mul-pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>mul<span class="dash">-</span>pow10: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">dp<span class="pc">dp: <span class="tp">int</span></span></a>) <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">yi<span class="pc">yi: <span class="tp">int</span></span></a>
  <a class="pp" href="#decimal_at">decimal-at<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal<span class="dash">-</span>at: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a>,<a class="pp">dp<span class="pc">dp: <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="#round_to_prec">round-to-prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>round<span class="dash">-</span>to<span class="dash">-</span>prec: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">rnd</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">round</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">mp<span class="pc">mp: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Divide two decimals up to a given precision &#96;max-prec&#96; (=&#96;~1&#96;).
// Use a negative precision to compute to the precision of the first argument.
</span><span class="decl-fun" id="_fs_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#_fs_">(/)<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span> ) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <a class="pp" href="#div">div<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>div: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a>,<a class="pp">y<span class="pc">y: <span class="tp">decimal</span></span></a>,<a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp">int</span></span></a>)
</span>}

<span class="comment">// Rounding modes.
</span><span class="decl-type" id="type_space_round"><span class="tp kw">type</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#type_space_round"><span class="tp">round</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>round: <span class="tp">V</span></span></a> {
  <span class="decl-con" id="con_space_Even"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#con_space_Even"><span class="co">Even</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Even: <span class="tp">round</span></span></a></span>
  <span class="decl-con" id="con_space_Floor"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#con_space_Floor"><span class="co">Floor</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Floor: <span class="tp">round</span></span></a></span>
  <span class="decl-con" id="con_space_Ceil"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#con_space_Ceil"><span class="co">Ceil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Ceil: <span class="tp">round</span></span></a></span>
  <span class="decl-con" id="con_space_Up"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#con_space_Up"><span class="co">Up</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Up: <span class="tp">round</span></span></a></span>
  <span class="decl-con" id="con_space_Down"><a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#con_space_Down"><span class="co">Down</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Down: <span class="tp">round</span></span></a></span>
</span>}

<span class="comment">// Round a decimal point number to an integer
</span><span class="decl-fun" id="int"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#int">int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">rnd</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">round</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">rnd<span class="pc">rnd: <span class="tp op">?</span><span class="tp">round</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">round</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#con_space_Even"><span class="co">Even</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Even: <span class="tp">round</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a> {
  <span class="kw">match</span>(<a class="pp">rnd<span class="pc">rnd: <span class="tp">round</span></span></a>) {
    <a class="pp" href="#con_space_Even"><span class="co">Even</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Even: <span class="tp">round</span></span></a> <span class="kw op">-></span> {
      <span class="kw">val</span> <a class="pp">half<span class="pc">half: <span class="tp">int</span></span></a><span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pow10">pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pow10: <span class="tp sp">(</span><span class="tp tpp">exp</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_fs_">/<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="fslash">/</span>): <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">y</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="number">2</span>
      <span class="kw">val</span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a>   <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
      <span class="kw">match</span>(<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#compare">compare<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>compare: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">order</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">half<span class="pc">half: <span class="tp">int</span></span></a>)) {
          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Eq"><span class="co">Eq</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Eq: <span class="tp">order</span></span></a> <span class="kw op">-></span> <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">q</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#even_ques_">even?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>even?: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a> <span class="kw">else</span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Gt"><span class="co">Gt</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Gt: <span class="tp">order</span></span></a> <span class="kw op">-></span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
          <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_Lt"><span class="co">Lt</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>Lt: <span class="tp">order</span></span></a> <span class="kw op">-></span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a>
      }
    }
    <a class="pp" href="#con_space_Floor"><span class="co">Floor</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Floor: <span class="tp">round</span></span></a> <span class="kw op">-></span> 
      <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <a class="pp" href="#con_space_Ceil"><span class="co">Ceil</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Ceil: <span class="tp">round</span></span></a> <span class="kw op">-></span> 
      <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <span class="kw">else</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <a class="pp" href="#con_space_Up"><span class="co">Up</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Up: <span class="tp">round</span></span></a> <span class="kw op">-></span> 
      <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#neg_ques__1">neg?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>neg?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> 
      <span class="kw">else</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
    <a class="pp" href="#con_space_Down"><span class="co">Down</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Down: <span class="tp">round</span></span></a> <span class="kw op">-></span> 
      <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">x</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pos_ques__1">pos?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pos?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> 
      <span class="kw">else</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>
  }
</span>}

<span class="comment">// Round the decimal-point number &#96;x&#96; to a specified precision &#96;p&#96; with a possible rounding mode &#96;rnd&#96; (=&#96;Even&#96;).
</span><span class="decl-fun" id="round_to_prec"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#round_to_prec">round-to-prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>round<span class="dash">-</span>to<span class="dash">-</span>prec: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">rnd</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">round</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>( <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a>, <a class="pp">rnd<span class="pc">rnd: <span class="tp op">?</span><span class="tp">round</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">round</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="#con_space_Even"><span class="co">Even</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Even: <span class="tp">round</span></span></a>) <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">p</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#neg_ques__1">neg?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>neg?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_lt__eq__1">&lt;=<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&lt;=)<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>) <span class="kw">then</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a> <span class="kw">else</span> {
    <span class="kw">val</span> <a class="pp">d<span class="pc">d: <span class="tp">int</span></span></a>   <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a> 
    <span class="kw">val</span> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a>   <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#cdiv_pow10">cdiv-pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>cdiv<span class="dash">-</span>pow10: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">int</span></span></a>)  
    <span class="kw">val</span> <a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>   <span class="kw">=</span> <a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#mul_pow10">mul-pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>mul<span class="dash">-</span>pow10: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">n</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">d<span class="pc">d: <span class="tp">int</span></span></a>)
    <span class="kw">val</span> <a class="pp">qr<span class="pc">qr: <span class="tp">int</span></span></a>  <span class="kw">=</span> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">q<span class="pc">q: <span class="tp">int</span></span></a>,<a class="pp">r<span class="pc">r: <span class="tp">int</span></span></a>,<a class="pp">d<span class="pc">d: <span class="tp">int</span></span></a>)<span class="kw op">.</span><a class="pp" href="#int">int<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>int: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">rnd</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">round</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">rnd<span class="pc">rnd: <span class="tp">round</span></span></a>)
    <span class="kw">val</span> <a class="pp">res<span class="pc">res: <span class="tp">decimal</span></span></a> <span class="kw">=</span> <a class="pp" href="#con_space_Decimal"><span class="co">Decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>Decimal: <span class="tp sp">(</span><span class="tp tpp">whole</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">frac</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">prec</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">x<span class="pc">x: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">qr<span class="pc">qr: <span class="tp">int</span></span></a>, <a class="pp">p<span class="pc">p: <span class="tp">int</span></span></a>)
    <span class="comment">// trace("round-to-prec: " + p.show + ", d: " + d.show +  ", q: " + q.show + ", x: " + x.fix.show + ", res: " + res.fix.show )// q1: " + q1.show + ", r:" + r.show + ", half:" + half.show)                  
</span>    <a class="pp">res<span class="pc">res: <span class="tp">decimal</span></span></a>
  }
</span>}

<span class="comment">// Show a decimal to a specified maximum precision (=&#96;~1&#96;). use a negative value to 
// use maximum precision required.
</span><span class="decl-fun" id="show"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#show">show<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>show: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">max<span class="dash">-</span>prec</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>( <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a>, <a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp op">?</span><span class="tp">int</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_optional"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>optional: <span class="tp">V</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_tilde_">~<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(~): <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="number">1</span> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_string"><span class="tp">string</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>string: <span class="tp">V</span></span></a> {
  <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#trace">trace<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>trace: <span class="tp sp">(</span><span class="tp tpp">message</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp sp">)</span></span></a>(<span class="st">"show: "</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">","</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">" prec:"</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>)
  <span class="kw">val</span> <a class="pp">fp<span class="pc">fp: <span class="tp">decimal</span></span></a>      <span class="kw">=</span> <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#round_to_prec">round-to-prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>round<span class="dash">-</span>to<span class="dash">-</span>prec: <span class="tp sp">(</span><span class="tp tpp">x</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">,</span> <span class="tp tpp">p</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">rnd</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">round</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">decimal</span></span></a>(<a class="pp">max-prec<span class="pc">max<span class="dash">-</span>prec: <span class="tp">int</span></span></a>)
  <span class="kw">val</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">tr<span class="pc">tr: <span class="tp">int</span></span></a>,<a class="pp">fr<span class="pc">fr: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a> <span class="kw">=</span> <a class="pp">fp<span class="pc">fp: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#truncfrac">truncfrac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>truncfrac: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>
  <span class="kw">val</span> <a class="pp">sign<span class="pc">sign: <span class="tp">string</span></span></a>    <span class="kw">=</span> <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">f</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#neg_ques_">neg?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>neg?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> <span class="st">"-"</span> <span class="kw">else</span> <span class="st">""</span>
  <a class="pp">sign<span class="pc">sign: <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">tr<span class="pc">tr: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#abs">abs<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>abs: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <span class="st">"."</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_plus__3">+<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(+)<span class="postfix">.3</span>: <span class="tp sp">(</span><span class="tp">string</span><span class="tp sp">,</span> <span class="tp">string</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a> <a class="pp">fr<span class="pc">fr: <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#abs">abs<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>abs: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#show_1">show<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>show<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pad_left">pad-left<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pad<span class="dash">-</span>left: <span class="tp sp">(</span><span class="tp tpp">s</span> <span class="tp kw op">:</span> <span class="tp">string</span><span class="tp sp">,</span> <span class="tp tpp">width</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">,</span> <span class="tp tpp">fill</span> <span class="tp kw op">:</span> <span class="tp op">?</span><span class="tp">char</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">string</span></span></a>(<a class="pp">fp<span class="pc">fp: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<span class="st">'0'</span>)
</span>}

<span class="comment">// Is this a negative decimal?
</span><span class="decl-fun" id="neg_ques_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#neg_ques_">neg?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>neg?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>( <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#neg_ques__1">neg?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>neg?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>
</span>}

<span class="comment">// Is this a positive decimal?
</span><span class="decl-fun" id="pos_ques_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#pos_ques_">pos?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>pos?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>( <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pos_ques__1">pos?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pos?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_bar__bar_">||<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(||): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> (<a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pos_ques__1">pos?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pos?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>)
</span>}

<span class="comment">// Is this a zero?
</span><span class="decl-fun" id="zero_ques_"><span class="kw">public</span> <span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>( <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_bool"><span class="tp">bool</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>bool: <span class="tp">V</span></span></a> {
  <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#zero_ques_">zero?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>zero?: <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>
</span>}

<span class="decl-fun" id="truncfrac"><span class="kw">fun</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_num_decimal.html#truncfrac">truncfrac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>truncfrac: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span></span></a>( <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a> <span class="tp kw op">:</span> <a class="pp" href="#type_space_decimal"><span class="tp">decimal</span><span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>decimal: <span class="tp">V</span></span></a> ) <span class="tp kw op">:</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space__lp__comma__rp_"><span class="tp">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><span class="tp sp">,</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space_int"><span class="tp">int</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>int: <span class="tp">V</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#type_space__lp__comma__rp_"><span class="tp">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp sp">(</span><span class="tp">V</span><span class="tp sp">,</span> <span class="tp">V</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">V</span></span></a> {
  <span class="kw">if</span> (<a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space_True"><span class="co">f</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>True: <span class="tp">bool</span></span></a><span class="kw op">.</span><a class="pp" href="#neg_ques_">neg?<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>neg?: <span class="tp sp">(</span><span class="tp tpp">f</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_amp__amp_">&amp;&amp;<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(&amp;&amp;): <span class="tp sp">(</span><span class="tp">bool</span><span class="tp sp">,</span> <span class="tp">bool</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a> <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pos_ques__1">pos?<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pos?<span class="postfix">.1</span>: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">bool</span></span></a>) <span class="kw">then</span> {
    <span class="kw">val</span> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a> <span class="kw">=</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#pow10">pow10<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>pow10: <span class="tp sp">(</span><span class="tp tpp">exp</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>(<a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#prec">prec<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>prec: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>)
    <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><span class="kw op">.</span><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#inc">inc<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>inc: <span class="tp sp">(</span><span class="tp tpp">i</span> <span class="tp kw op">:</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>, <a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#_dash_">-<span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(<span class="dash">-</span>): <span class="tp sp">(</span><span class="tp">int</span><span class="tp sp">,</span> <span class="tp">int</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a> <a class="pp">base<span class="pc">base: <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
  }
  <span class="kw">else</span> <a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">(</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a><a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#whole">whole<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>whole: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a>,<a class="pp">f<span class="pc">f: <span class="tp">decimal</span></span></a><span class="kw op">.</span><a class="pp" href="#frac">frac<span class="pc"><span class="mo">std<span class="fslash">/</span>num<span class="fslash">/</span>decimal<span class="fslash last">/</span></span>frac: <span class="tp sp">(</span><span class="tp tpp">decimal</span> <span class="tp kw op">:</span> <span class="tp">decimal</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp">int</span></span></a><a class="pp" href="https://koka-lang.github.io/koka/doc/std_core-source.html#con_space__lp__comma__rp_"><span class="co">)</span><span class="pc"><span class="mo">std<span class="fslash">/</span>core<span class="fslash last">/</span></span>(,): <span class="tp kw">forall</span><span class="tp sp">&lt;</span><span class="tp tv">a</span><span class="tp sp">,</span><span class="tp tv">b</span><span class="tp sp">&gt;</span> <span class="tp sp">(</span><span class="tp tpp">fst</span> <span class="tp kw op">:</span> <span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tpp">snd</span> <span class="tp kw op">:</span> <span class="tp tv">b</span><span class="tp sp">)</span> <span class="tp kw op">-></span> <span class="tp sp">(</span><span class="tp tv">a</span><span class="tp sp">,</span> <span class="tp tv">b</span><span class="tp sp">)</span></span></a>
</span>}

</pre>

</div></body>
</html>
